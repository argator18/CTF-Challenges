import json
import base64
import pwn

def main():
    host = "authentication_server.rumble.host"
    port = 3834
    
    p = pwn.remote(host,port)

    
    data_input = p.recvuntil(b"}")


    # Splitting the encrypted message from the JSON keys
    encrypted_data, json_keys = data_input.split(b'{"pk":', 1)
    json_keys = b'{"pk":' + json_keys

    # Decode the encrypted data from Base64
    decoded_data = base64.b64decode(encrypted_data)

    # Load the JSON keys into a Python dictionary
    keys = json.loads(json_keys)
    pk = base64.b64decode(keys['pk'])
    sk = base64.b64decode(keys['sk'])

    # Printing results for verification
    print("Decoded Encrypted Data:", decoded_data)
    print("pk: ", pk)
    print("sk: ", sk)

if __name__ == "__main__":
    main()

